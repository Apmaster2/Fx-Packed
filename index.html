<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fx Packed</title>
    <link rel="icon" href="assets/fx_packed_logo.png" sizes="16x16">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Fx Packed</h1>
    <h2>By Ap (Apmaster3)</h2>
    <label>
        Fx Type:
    </label>
    <select id="fxType" onchange="updateButtons()">
        <option value="circle">Circle</option>
        <option value="Sphere">Sphere</option>
    </select>
    <div class="argument">
        <label>
            <span>
                Particle:
            </span>
        </label>
        <input id="particle" type="text" placeholder="minecraft:end_rod">
    </div>




    <div class="circleFx" id="circleFx">
        <div class="argument">
            <label>
                Radius:
            </label>
            <input id="radius" type="number" placeholder=5 min=1 step=0.5>
        </div>
        <div class="argument">
            <label>
                Particle Count:
            </label>
            <input id="particleCount" type="number" placeholder=36 min=1 step=1>
        </div>
        <div class="argument">
            <label>
                Axis:
            </label>
            <select id="axis" onchange="updateDirection()">
                <option value="horizontal">Horizontal</option>
                <option value="vertical">Vertical</option>
            </select>
        </div>
        <div class="argument" id="directions" style="display: none">
            <label class="tooltip">
                Direction:
                <span class="tooltipText">The direction the FX should be facing</span>
            </label>
            <select id="direction">
                <option value="x">X</option>
                <option value="z">Z</option>
            </select>
        </div>
        <div class="argument" id="coordinateMode" onchange="updateDirection()">
            <label class="tooltip">
                Coordinate Mode:
                <span class="tooltipText">The way the FX is rotated</span>
            </label>
            <select id="mode">
                <option value="world">World (~)</option>
                <option value="local">Local (^)</option>
            </select>
        </div>
        <div class="argument"  onchange="motionTypeChange()">
            <label>
                Motion Type:
            </label>
            <select id="motionType">
                <option value="still">Still</option>
                <option value="outwards">Outwards</option>
                <option value="inwards">Inwards</option>
                <option value="upwards">Upwards</option>
                <option value="downwards">Downwards</option>
                <option value="left">Left</option>
                <option value="right">Right</option>
            </select>
        </div>
        <div class="argument" id="motionVelocity" style="display: none">
            <label class="tooltip">
                Velocity:
                <span class="tooltipText">The speed at which the particles move at</span>
            </label>
            <input id="velocity" type="number" placeholder=1 min=1 step=0.1>
        </div>
    </div>
    

    
    <button onclick="generateFx()">Generate</button>



    <div class="output" id="output"></div>




    <script>

        let output = "";


        function motionTypeChange() {
            updateDirection();
            updateVelocity();
        }


        function updateButtons() {
            const fxType = document.getElementById('fxType').value.trim();

            document.getElementById('circleFx').style.display = 'none';

            if(fxType == "circle") {
                document.getElementById('circleFx').style.display = '';
            }
        }


        function updateDirection() {
            const axis = document.getElementById('axis').value.trim();
            const mode = document.getElementById('mode').value.trim();
            const motion = document.getElementById('motionType').value.trim();

            if(axis == "vertical" && mode == "world" && motion == "still") {
                document.getElementById('directions').style.display = '';
            } else {
                document.getElementById('directions').style.display = 'none';
            }
        }

        function updateVelocity() {
            const motion = document.getElementById('motionType').value.trim();

            if(motion != "still") {
                document.getElementById('coordinateMode').style.display = 'none';
                document.getElementById('motionVelocity').style.display = '';
            } else {
                document.getElementById('coordinateMode').style.display = '';
                document.getElementById('motionVelocity').style.display = 'none';
            }
        }

        function generateFx() {

            const fxType = document.getElementById('fxType').value.trim();
            const particle = document.getElementById('particle').value.trim();
            const radius = document.getElementById('radius').value.trim();
            const particleCount = document.getElementById('particleCount').value.trim();
            const axis = document.getElementById('axis').value.trim();
            const direction = document.getElementById('direction').value.trim();
            const mode = document.getElementById('mode').value.trim();
            const motion = document.getElementById('motionType').value.trim();
            const velocity = document.getElementById('velocity').value.trim();

            document.getElementById('output').style.visibility = 'visible';

            if(fxType == "circle") {
                output = generateCircle(particle, radius, particleCount, axis, direction, mode, motion, velocity);
            }
            
            document.getElementById('output').innerText = 'Copied To Clipboard!\n\n' + output;
            navigator.clipboard.writeText(output);
        }


        function generateCircle(particle, radius, particleCount, axis, direction, mode, motion, velocity) {
            if(!particle) {particle = "minecraft:end_rod"}
            if(!radius) {radius = 5}
            if(!particleCount) {particleCount = 36}
            if(!velocity) {velocity = 1}

            let particles = "";

            let symbol = "~";
            

            if(mode == "local") {
                symbol = "^";
            }

            

            for(let i = 0; i < particleCount; i++) {
                let angle = 360 / particleCount * i;
                let intervalAngle = 2 * Math.PI * i / particleCount;

                let x = 0;
                let y = 0;
                let z = 0;

                if(axis == "horizontal") {
                    x = (Math.cos(intervalAngle) * radius).toFixed(3);
                    z = (Math.sin(intervalAngle) * radius).toFixed(3);

                } else {
                    if(mode == "world" && direction == "z") {
                        z = (Math.cos(intervalAngle) * radius).toFixed(3);
                    } else {
                        x = (Math.cos(intervalAngle) * radius).toFixed(3);
                    }
                    y = (Math.sin(intervalAngle) * radius).toFixed(3);
                }



                const invertedMotionTypes = ["inwards", "downwards", "left"];
                const distanceMotionTypes = ["inwards", "upwards", "downwards", "left", "right"];

                if(motion == "still") {
                    particles += `particle ${particle} ${symbol}${x} ${symbol}${y} ${symbol}${z} 0 0 0 0 1\n`   
                } else {
                    let motionX = "";
                    let motionY = "";
                    let motionZ = "";
                    let motionDirection = "";
                    let motionDistance = "";
                    if(distanceMotionTypes.includes(motion)) {
                        motionDistance = radius;
                    }

                    let yaw = "~";
                    let pitch = "~";
                    if(axis == "horizontal") {
                        yaw = angle;
                        pitch = "0";
                    } else if(axis == "vertical") {
                        pitch = angle;
                    }

                    if(motion == "outwards" || motion == "inwards") {
                        motionZ = 1000000;
                        if(invertedMotionTypes.includes(motion)) {
                            motionZ = "-" + motionZ;
                        }
                    } else if(motion == "upwards" || motion == "downwards") {
                        motionY = 1000000
                        if(invertedMotionTypes.includes(motion)) {
                            motionY = "-" + motionY;
                        }
                    } else if(motion == "left" || motion == "right") {
                        motionX = 1000000
                        if(invertedMotionTypes.includes(motion)) {
                            motionX = "-" + motionX;
                        }
                    }
                    particles += `execute rotated ${yaw} ${pitch} positioned ^ ^ ^${motionDistance} run particle ${particle} ~ ~ ~ ^${motionX} ^${motionY} ^${motionZ} ${(0.0000001 * velocity).toFixed(8)} 0\n`

                       
                }
 
            

            }
            return particles;
        }


    </script>
</body>
</html>